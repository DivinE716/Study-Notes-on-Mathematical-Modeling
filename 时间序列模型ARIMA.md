# 时间序列模型ARIMA

## 1. 模型介绍

AR模型，即自回归模型，其优势是对于具有**较长历史趋势**的数据，AR模型可以捕获这些趋势，并据此进行预测。但是AR模型不能很好地处理某些类型的时间序列数据，例如那些有临时、突发的变化或者噪声较大的数据。AR模型相信“历史决定未来”，因此很大程度上忽略了现实情况的复杂性、也忽略了真正影响标签的因子带来的不可预料的影响。

相反地，MA模型，即移动平均模型，可以更好地处理那些**有临时、突发的变化或者噪声较大**的时间序列数据。但是对于具有较长历史趋势的数据，MA模型可能无法像AR模型那样捕捉到这些趋势。MA模型相信“时间序列是相对稳定的，时间序列的波动是由偶然因素影响决定的”，但现实中的时间序列很难一直维持“稳定”这一假设。

基于以上两个模型的优缺点，我们引入了ARIMA模型，这是一种结合了AR模型和MA模型优点的模型，可以处理更复杂的时间序列问题。

要学习时间序列模型，首先我们要理解并区分**时期序列**和**时点序列**。
1. **时期序列**中的观测值反映现象在一段时期内发展过程的总量，不同时期的观测值**可以相加**，相加结果表明现象在更长一段时间内的活动总量，如中国过去10年的GDP序列；
2. **时点序列**中的观测值反映现象在某一瞬间上所达到的水平，不同时期的观测值**不能相加**，相加结果没有实际意义，如某地每隔一小时测得的温度数据。

ARIMA的建模思路大致如下：

![ARIMA模型大纲](/imgs/2025-10-21/xpN6co0D9f09Au2H.png)

即：
1. 对序列绘图，进行平稳性检验，观察序列是否平稳；对于非平稳时间序列要先进行d 阶差分,转化为平稳时间序列；
2. 过第一步处理，已经得到平稳时间序列。要对平稳时间序列分别求得其自相关系数（ACF）和偏自相关系数（PACF），通过对自相关图和偏自相关图的分析或通过AIC/BIC搜索，得到最佳的阶数p、q；
3. 以上得到的d、q、P，得到 ARIMA 模型。然后开始对得到的模型进行模型检验。

## 2. 模型公式推导

先回顾一下AR和MA模型的数学表达式: 

$$AR: Y_t = c + \varphi_1 Y_{t-1} + \varphi_2 Y_{t-2} + \dots + \varphi_p Y_{t-p} + \xi_t$$

$$MA: Y_t = \mu + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_q \epsilon_{t-q}$$ 

如果我们暂时不考虑差分（即假设d=0），那么ARIMA模型可以被看作是AR模型和MA模型的直接结合，形式上看，ARIMA模型的公式可以表示为：

$$Y_t = c + \varphi_1 Y_{t-1} + \varphi_2 Y_{t-2} + \dots + \varphi_p Y_{t-p} + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_q \epsilon_{t-q} + \epsilon_t$$

在这个公式中：
- $Y_t$ 是我们正在考虑的时间序列数据。
- $\varphi_1$到 $\varphi_p$是AR模型的参数，这些参数用来描述当前值与过去p个时间点值之间的关系。
- $\theta_1$到 $\theta_q$是MA模型的参数，这些参数用来描述当前值与过去q个时间点的误差之间的关系。
- $\epsilon_t$是在t时间点的误差项。
- $c$是一个常数项。

这个公式基本上是将AR模型和MA模型的公式组合在一起: 

1、AR部分（即 $\varphi_1 Y_{t-1} + \varphi_2 Y_{t-2} + \dots + \varphi_p Y_{t-p}$）表示当前值 $Y_t$ 与它过去的值有关，这个部分的形式与AR模型的公式一致。

2、MA部分（即 $\theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_q \epsilon_{t-q}$）表示当前值 $Y_t$ 与它过去的误差项有关，这个部分的形式与MA模型的公式一致。

不难发现，MA模型中代表长期趋势的均值 $\mu$ 并不存在于ARIMA模型的公式当中，因为ARIMA模型中“预测长期趋势”这部分功能由AR模型来执行，因此AR模型替代了原本的 $\mu$ 。值得注意的是，在ARIMA模型中， $c$ 可以为0。

另外，这个公式的基础是假设我们正在处理的时间序列是平稳的，这样我们可以直接应用AR和MA模型。如果时间序列是非平稳的，那么我们就需要考虑ARIMA模型中的“I”部分，也就是进行差分处理。

上述模型被称之为ARIMA(p,d,q)模型，其中p和q的含义与原始MA、AR模型中完全一致，且p和q可以被设置为不同的数值，而d是ARIMA模型需要的差分的阶数。

## 3. ARIMA中的三个参数
### 3.1 d（差分）

差分

>参考：[时间序列模型(四)：ARIMA模型 - 知乎](https://zhuanlan.zhihu.com/p/634120397)
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTQ3MzEwNTA0MiwxMTI0MzU2ODg4LDE4MD
I0NjgzNzMsLTMxMjk3NzU5NSw1Njk4OTE2ODYsNDIyODQ4NTAz
XX0=
-->