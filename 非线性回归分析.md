# 非线性回归分析
## 1. 与线性回归的对比
|        | 线性回归 | 非线性回归 |
|:-------:|:------:|:---------:|
| 数学表达式 | $Y = \beta_0 + \beta_1 X_1 + \varepsilon$| $y = f(x, \theta) + \varepsilon$|
| 函数形式 | 直线、平面或超平面 | 曲线、曲面，如指数函数、对数函数、幂函数等 |
| 计算复杂度 | 简单，有闭式解 | 复杂，通常需要迭代求解 |
| 参数估计方法 | 最小二乘法 | 非线性最小二乘法、最大似然估计、迭代算法 |
| 可解释性 | 系数直接表示变量对因变量的影响程度 | 参数解释相对复杂，需要结合函数形式 |
| 模型稳定性 | 稳定性好，不易过拟合 | 稳定性相对较差，容易过拟合 |
| 样本量要求 | 对样本量要求相对较低 | 通常需要较大的样本量 |
| 适用场景 | 变量间关系简单、线性趋势明显 | 变量间关系复杂、存在非线性趋势 |
| 常见类型 | 简单线性回归，多元线性回归，多项式回归(线性于参数) | 指数回归，对数回归，幂函数回归，Logistic回归 |
| 优点 | 计算简单快速，结果易于解释，统计推断完善，不易过拟合 | 拟合能力强，能处理复杂关系，预测精度高，应用范围广 |
| 缺点 | 只能处理线性关系，对非线性数据拟合差，模型表达能力有限 | 计算复杂，容易过拟合，参数初值敏感，可能无法收敛 |
| 评估指标 | $R^2$、调整 $R^2$、AIC、BIC、F统计量 | $R^2$、AIC、BIC、均方误差(MSE)、残差标准误差 |
| 实际应用 | 经济学分析，市场研究，质量控制，简单预测模型 | 生物学增长模型，药物动力学，工程系统建模，机器学习 |

# 2. 非线性回归类型

非线性回归，可分为可线性变换的回归与不可线性变换的回归两大类。

![非线性回归类型](https://pic2.zhimg.com/v2-3730c0623f4ae713e6b0b7fee82d0057_r.jpg)

## 2.1 可线性变换的非线性回归
有些曲线关系经过特殊的数据转换后，可呈现为线性关系，因此采用转换后的数据进行**线性回归**拟合获得相应结果，最后再将结果逆转得到曲线方程或计算出原始的预测值。

该过程在统计软件中可以由两种方式完成，一种是先对数据做转换，然后执行线性回归；另一种是直接采用曲线回归(常见可转换的曲线函数)的方式进行非线性回归。总的原理，仍然属于线性回归范畴。

以三次曲线为例， $y = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3$，对自变量 $x$的数据先计算二次方值 $x^2$，再计算三次方值 $x^3$，分别另存为两个新的变量，如 $x_2$和 $x_3$，此时回归方程为

$$Y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3,$$

转换为含有三个自变量的线性回归方程。以 $x_1$、 $x_2$、 $x_3$为自变量， $y$为因变量进行多重线性回归，也可以直接采用曲线回归中的“三次曲线函数”直接拟合曲线回归方程。

## 2.2 不可线性变换的非线性回归
许多曲线关系是无法通过数据转换的方式进行线性回归的，曲线回归只针对可转换的曲线关系，并且常用的曲线回归函数仅可考察一个自变量，无法对复杂曲线关系进行拟合。

非线性回归则可灵活的解决以上问题，它可以估计因变量和自变量之间具有任意关系的回归模型，回归方程的表达式没有局限性，理论上可以拟合任何非线性关系。

## 2.3 常见的曲线回归方程
| 曲线名称 | 曲线拟合模型表达式 |
|:--------:|:---------------------------------:|
| 二次曲线 | $y = \beta_0 + \beta_1 x + \beta_2 x^2$ |
| 三次曲线 | $y = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3$ |
| 对数曲线 | $y = \beta_0 + \beta_1 \ln x$ |
| 指数曲线 | $y = \beta_0 e^{\beta_1 x}$ |
| 复合曲线 | $y = \beta_0 \beta_1^x$ |
| 增长曲线 | $y = e^{\{\beta_0 + \beta_1^x\}}$ |
| S曲线 | $y = e^{\{\beta_0 + \frac{\beta_1}{x}\}}$ |

## 2.4 模型选择准则
在抉择使用线性模型还是非线性模型之前，我们可以绘制出数据集的散点图/残差图，如果散点图呈现明显的非线性关系/残差图显示出了**系统性偏差**（符合线性回归的数据的残差一般围绕0上下波动），则可以考虑选择非线性模型。

在进行非线性模型的选择时，我们可以参考下面的指标：
- AIC（赤池信息准则）：越小越好，
- BIC（贝叶斯信息准则）：越小越好，
- 调整 $R^2$：考虑参数个数的影响，

其中，AIC、BIC的本质都是平衡“模型复杂度”与“模型拟合度”的指标，而**AIC更倾向于拟合度更高的模型**，适合预测场景；**BIC则更倾向于复杂度更低的模型**，适合探索数据之间的真实规律。
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE0MTkzODMwOTZdfQ==
-->